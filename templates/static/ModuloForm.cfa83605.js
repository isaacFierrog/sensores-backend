import{D as P,B as Q,g as u,m as E,E as w,_ as W,o as m,c as d,f as s,x as A,y as B,F as z,h as V,t as I,i as S,z as X,q as Y,p as Z,e as $}from"./index.f4e62138.js";const ee="http://3.101.0.40:8000/api/",y=P.create({baseURL:ee}),x="modulos/",M=localStorage,L={get(){return y.get(x,{headers:{Authorization:`Bearer ${M.getItem("access")}`,"Content-type":"application/json; charset=utf-8"}})},create(r){return y.post(x,r,{headers:{Authorization:`Bearer ${M.getItem("access")}`,"Content-type":"application/json; charset=utf-8"}})},retrieve(r){return y.get(`${x}${r}/`,{headers:{Authorization:`Bearer ${M.getItem("access")}`,"Content-type":"application/json; charset=utf-8"}})},update(r,o){return y.patch(`${x}${r}/`,o,{headers:{Authorization:`Bearer ${M.getItem("access")}`,"Content-type":"application/json; charset=utf-8"}})}},ae=(r,{emit:o})=>{const{verFormulario:p,modulo:e}=Q(r),t=u(""),c=u(""),a=u(""),n=u([]),i=u(0),_=u(!1),f=u(!1),g=u(!1),h=u(!1),F=u(["HERMOSILLO","CANANEA"]),U=u(["A","B","C","D"]),j=()=>{!e.value||(t.value=e.value.mac,c.value=e.value.mina,a.value=e.value.area,n.value=e.value.sensores.map(l=>({clave:l.clave})),i.value=n.value.length)},k=()=>o("refrescarModulos"),C=()=>{t.value="",c.value="",a.value="",n.value=[]},v=()=>{h.value=!1,g.value=!1,f.value=!1,_.value=!1},N=()=>{C(),v(),o("ocultarFormulario")},O=()=>{if(!G.value){v(),_.value=!0;return}v(),i.value++;const l={clave:`${t.value.toUpperCase()}-${i.value}`};n.value.push(l)},R=()=>{i.value!==0&&(i.value--,n.value.pop())},q=async()=>{if(v(),!T.value){h.value=!0;return}try{let l=null;e.value?l=await L.update(e.value.id,{mac:t.value.toUpperCase(),mina:c.value.toUpperCase(),area:a.value.toUpperCase(),sensores:n.value}):l=await L.create({mac:t.value.toUpperCase(),mina:c.value.toUpperCase(),area:a.value.toUpperCase(),sensores:n.value});const{data:J}=await l;k(),C(),f.value=!0}catch{g.value=!0}},H=E(()=>({"ocultar-layout":!p.value})),G=E(()=>!!t.value.length),T=E(()=>!!t.value.length&&!!c.value.length&&!!a.value.length);return j(),w(t,(l,J)=>{let D=1;l.length||(i.value=0),n.value=n.value.map(()=>{const K=`${l.toUpperCase()}-${D}`;return D++,{clave:K}})}),w(p,()=>j()),{verFormulario:p,mac:t,mina:c,area:a,sensores:n,numeroSensores:i,mensajeSensores:_,mensajeExito:f,mensajeError:g,mensajeCampos:h,minas:F,areas:U,mostrarFormulario:H,crearModulo:q,ocultarFormulario:N,agregarSensores:O,eliminarSensores:R}};const oe={props:{verFormulario:{type:Boolean,default:!1},modulo:{type:Object,required:!1}},setup(r,o){const{verFormulario:p,mac:e,mina:t,area:c,sensores:a,numeroSensores:n,mensajeSensores:i,mensajeExito:_,mensajeError:f,mensajeCampos:g,minas:h,areas:F,mostrarFormulario:U,crearModulo:j,ocultarFormulario:k,agregarSensores:C,eliminarSensores:v}=ae(r,o);return{verFormulario:p,mac:e,mina:t,area:c,sensores:a,numeroSensores:n,mensajeSensores:i,mensajeExito:_,mensajeError:f,mensajeCampos:g,minas:h,areas:F,mostrarFormulario:U,crearModulo:j,ocultarFormulario:k,agregarSensores:C,eliminarSensores:v}}},b=r=>(Z("data-v-7f56ed59"),r=r(),$(),r),se=b(()=>s("h2",{class:"txt-upper blanco-a titulo-modulo"},"Crear modulo",-1)),re=b(()=>s("p",{class:"blanco-a form__label"},"Mac",-1)),te=b(()=>s("p",{class:"blanco-a form__label"},"Mina",-1)),ne={class:"form__input",id:"minas"},le=["value"],ue=b(()=>s("p",{class:"blanco-a form__label"},"Area",-1)),ce={class:"form__input",id:"areas"},ie=["value"],me={class:"sensores"},de=b(()=>s("input",{type:"submit",class:"boton-crear boton-modulo blanco-a txt-upper",value:"Guardar"},null,-1)),pe={key:0,class:"mensaje mensaje--error"},ve={key:1,class:"mensaje mensaje--error"},_e={key:2,class:"mensaje mensaje--error"},fe={key:3,class:"mensaje mensaje--exito"};function ge(r,o,p,e,t,c){return m(),d("div",{class:Y(["layout-modulo-form",e.mostrarFormulario])},[s("button",{class:"txt-upper blanco-a titulo-modulo boton-cerrar",onClick:o[0]||(o[0]=(...a)=>e.ocultarFormulario&&e.ocultarFormulario(...a))}," x "),se,s("form",{class:"form",onSubmit:o[6]||(o[6]=X((...a)=>e.crearModulo&&e.crearModulo(...a),["prevent"]))},[re,A(s("input",{type:"text",class:"form__input","onUpdate:modelValue":o[1]||(o[1]=a=>e.mac=a)},null,512),[[B,e.mac]]),te,A(s("input",{type:"text",list:"minas",class:"form__input","onUpdate:modelValue":o[2]||(o[2]=a=>e.mina=a)},null,512),[[B,e.mina]]),s("datalist",ne,[(m(!0),d(z,null,V(e.minas,a=>(m(),d("option",{key:a,value:a},I(a),9,le))),128))]),ue,A(s("input",{type:"text",list:"areas",class:"form__input","onUpdate:modelValue":o[3]||(o[3]=a=>e.area=a)},null,512),[[B,e.area]]),s("datalist",ce,[(m(!0),d(z,null,V(e.areas,a=>(m(),d("option",{key:a,value:a},I(a),9,ie))),128))]),s("section",me,[s("div",{class:"sensores__boton blanco-a",onClick:o[4]||(o[4]=(...a)=>e.eliminarSensores&&e.eliminarSensores(...a))}," - "),s("p",null,"Sensores: "+I(e.numeroSensores),1),s("div",{class:"sensores__boton blanco-a",onClick:o[5]||(o[5]=(...a)=>e.agregarSensores&&e.agregarSensores(...a))}," + ")]),de,e.mensajeSensores?(m(),d("p",pe," Debes de agregar una MAC antes de agregar sensores ")):S("",!0),e.mensajeCampos?(m(),d("p",ve,"Debes de llenar todos los campos antes de guardar")):S("",!0),e.mensajeError?(m(),d("p",_e,"Debes de llenar todos los campos")):S("",!0),e.mensajeExito?(m(),d("p",fe,"Modulo creado exitosamente")):S("",!0)],32)],2)}const be=W(oe,[["render",ge],["__scopeId","data-v-7f56ed59"]]);export{be as default};
